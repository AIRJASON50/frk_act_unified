arXiv:2212.09234v2 \[cs.RO\] 9 Jun

2023

## **实时可变形接触感知模型预测控制用于力调节操作**

**摘要**

机器人机械手力的调节已被广泛研究数十年。然而，由于缺乏精确的交互接触建模和对交互力调节的性能保证不足，它尚未普遍用于安全关键应用。本研究提出了一个高层框架，用于同时优化机械手与易受外部干扰的软环境之间交互的轨迹和力控制。考虑了滑动摩擦和法向接触力。软接触模型和机械手的动力学同时纳入轨迹优化器中，以生成所需的运动和力曲线。基于交替方向乘子法（ADMM）的约束优化框架已被用于以模型预测控制（MPC）的方式高效生成实时最优控制输入和高维状态轨迹。使用笛卡尔空间力控制模式，在具有已知材料特性的软基板上对模型性能进行了实验验证。结果显示了在摩擦模型的有效范围内，多个笛卡尔运动的真实值与基于实时模型的接触力与运动跟踪的比较。结果表明，基于接触模型的运动规划器可以补偿摩擦力和运动干扰，并提高整体运动和力跟踪精度。所提出的高层规划器有潜力促进涉及柔顺、精细和可变形组织操作的医疗任务的自动化。

## **I. 引言**

在过去的几十年中，机器人技术在医疗领域的应用越来越受到关注，其中机器人与其环境之间的交互力规划和控制对于各种安全关键任务至关重要。例如，在柔顺环境中，如手术环境、微组装或生物组织操作中，应精确调节交互力。此外，基于可识别物理模型的力控制对于识别不稳定性模式（例如，由带宽和系统结构引起的不稳定性）和保持可靠的力交互以保证安全至关重要。因此，一种具有高保真接触模型的基于模型的轨迹规划方法对于成功部署并获得令人满意的运动和接触力跟踪性能至关重要。

在基于模型的规划和仿真领域，在处理刚性接触和可变形接触模型方面进行了广泛的研究。例如，刚性接触可以使用互补问题的数值解来建模，或者使用具有冲击动力学的混合模型。与刚体接触不同，软接触模型面临非线性材料特性和不均匀性带来的挑战，以及由于数值计算解决方案而产生的密集计算负担。在物理交互过程中考虑软接触力学对于安全适应和规划很重要，尤其是在机器人手术应用中。软接触建模具有挑战性，因为它取决于材料特性、变形和滚动摩擦。文献中提出了许多接触模型来模拟涉及弹性变形的相互作用。这些模型具有广泛的应用，在许多工程领域（如机械设计、机器人技术、多体分析等）中至关重要。对于涉及弹性的接触问题，赫兹粘附接触理论已得到很好的建立。在本研究中，我们专注于与软组织相互作用的机器人任务，其接触行为不仅由外部力和粘性力以及接触几何形状决定，还由材料特性决定（参见图1）。

图1：KUKA机械手实验设置。机械手在软表面上执行力控运动任务。

许多机器人任务需要在受限环境中存在接触的情况下进行运动规划。例如，在医疗应用的自动化中，环境受到严格限制，安全性至关重要。在这种情况下，机器人运动和施加在环境上的反作用力是耦合在一起的。类似的例子可以在自动化制造、腿式运动和辅助机器人技术中找到。作为沿着这个方向的一个有前途的方法，轨迹优化（TO）与硬或软互补约束或显式接触模型已在机器人社区中进行了广泛研究。通过将接触力和关节状态纳入优化，可以为复杂的机器人行为（如动态运动或灵巧物体操作）规划出与接触动力学一致的运动。虽然上述工作在自动发现接触序列方面取得了令人印象深刻的结果，但优化后的接触力并未用于控制，仅作为探索与物体物理交互的一种方式。在这项工作中，我们旨在精确跟踪标称力轨迹以及末端执行器路径，这在安全关键任务中通常需要但尚未充分探索。

安全关键任务，如软材料操作和医疗应用，需要精确接触交互的广泛操作。这些包括与人近距离或直接物理接触的交互。在解决操作交互问题时，已经探索了各种方法，包括基于模型和无模型方法。数据驱动技术已被研究用于学习机器人机械手与环境之间的相互作用。与刚性接触不同，软环境容易受到空间和时间上的不确定性影响，同时通过数据学习接触模型和机器人动力学具有挑战性。相比之下，基于模型的方法可以以合理的保真度捕获接触动力学的主要成分，并与适当的规划框架一起使用。这些研究提出了结合接触模型的控制框架和传感器模态，以做出明智的控制决策，包括基于物理的接触模型、基于网格的仿真模型和触觉模型。然而，在这些研究中，同时进行运动和力跟踪的探索不足。我们的方法将具有力和摩擦分量的接触建模为平滑的动力学系统，以增强机器人动力学。然后，我们将其嵌入到接触感知TO中，以进行高保真规划。

由于接触丰富的环境容易受到干扰，并且难以建模或预测，因此在线解决上述优化问题并更新接触状态信息是必不可少的。然而，高效解决具有完整机器人和接触动力学的高度约束TO仍然是一个开放问题。我们没有以整体方式解决大规模优化问题，而是提出了一种受腿式运动社区工作启发的分布式优化框架，但采用了一种不同的方式来分解给定软操作任务的原始问题。更具体地说，该框架在三个子问题/子块之间高效交替：（i）一个无约束子问题，仅包含耦合刚体（即机器人末端执行器）和软接触动力学，用于精确力跟踪；（ii）一个逆运动学（IK）子问题，生成关节轨迹以跟踪所需的末端执行器轨迹；（iii）一个约束投影子问题，用于处理包括接触约束在内的不等式约束。所提出的分布式框架支持以模型预测控制（MPC）方式在线执行。此外，为了保持接触和稳定性，需要在高层轨迹规划器之上部署一个额外的控制层。我们添加了一个低层导纳力控制器来处理模型以及环境中干扰引起的不确定性。

本工作的主要贡献如下：

* 提出了基于软接触力学的动态交互模型，用于预定义几何形状和赫兹粘弹性理论。  
* 将交互模型纳入约束TO中，以高效、分布式的方式生成所需的笛卡尔路径和力曲线。  
* 实验验证了推导出的接触动力学模型，并实时实现了所提出的TO算法与模型预测控制（MPC）。

本文所呈现工作的会议版本已发表在\[45\]中。这里呈现的工作在三个方面扩展了之前的工作。首先，我们将之前的分布式框架扩展为三个子问题，而不是只有两个，即从之前的动力学块中提取一个独立的IK子问题，以进一步分离动力学（力跟踪）和运动学（末端执行器跟踪）规划。我们对解决相同约束TO问题的不同版本进行了基准测试，包括我们在会议版本\[45\]中提出的版本。其次，我们提出的轨迹规划器以MPC方式在线执行。我们通过实验证明了该框架在静态和动态干扰引起的平台上同时进行运动和力跟踪任务的有效性。最后但同样重要的是，我们实现了一个低层控制器来辅助高层轨迹规划器进行运动和力轨迹跟踪。

## **II. 相关工作**

**接触模型。** 弹性接触力学已在各种研究领域中进行了广泛研究，其中接触建模对于安全和性能要求至关重要。现有工作在\[10\]、\[46\]-\[48\]中使用了软接触模型进行建模和控制。这些工作包括准静态假设，\[49\]、\[50\]的研究探讨了高速冲击软材料的情况。在冲击情况下，粘弹性模型已被广泛研究。例如，\[10\]、\[49\]的研究比较了各种粘弹性模型并进行了实验验证。这些工作中的大多数表明，基于赫兹的Hunt-Crossey模型最适合粘弹性情况。此外，摩擦滑动运动的基本原理在\[13\]、\[51\]的工作中建立，其中主要关注刚体接触但可推广到软接触。最近的工作在\[12\]、\[52\]中提出了基于接触面积的模型。

**轨迹优化。** 轨迹优化（TO）是生成可靠和智能机器人运动的强大工具。已经提出了各种数值优化方法来解决TO。其中，微分动态规划（DDP）及其一阶变体迭代线性二次调节器（iLQR）在解决无约束问题（仅强制动力学约束）的TO方面引起了广泛关注。DDP或iLQR中的Ricatti式反向传递通过在整个时间范围内解决近似LQR问题有效地降低了复杂性，并且优化以迭代方式解决。在\[58\]中，DDP用于高自由度（DoFs）人形机器人的平衡任务。后续工作\[59\]展示了基于DDP的模型预测控制（MPC）实现。然而，在标准DDP算法中加入额外约束仍然是一个开放问题。在\[60\]-\[70\]中，提出了DDP型变体来处理包含状态或控制变量的等式或不等式约束。同时，提出了一种基于增广拉格朗日（AL）的方法，即交替方向乘子法（ADMM）\[71\]，以分布式方式解决约束优化问题。在\[72\]、\[73\]中，ADMM用于解决具有箱形和锥形约束的大规模凸问题。尽管收敛性仅对凸问题有保证，但ADMM已被证明对于解决高度非凸问题有效，例如避碰\[74\]、\[75\]、混合整数规划\[76\]、\[77\]、线性互补问题\[78\]，最近还用于腿式机器人轨迹规划\[40\]、\[41\]。我们的方法利用了ADMM的分布式特性和DDP的效率，将原始问题分解为无约束全身动力学规划与软接触模型、运动学规划和约束投影。

**软接触轨迹优化。** 针对腿式运动和灵巧物体操作的接触感知TO通常建立在刚性接触动力学假设之上。在\[25\]、\[26\]、\[79\]中，软接触模型被集成到系统动力学中以近似硬接触，并且接触模型仍然相对简单。在\[80\]中，在全身运动控制的优化公式中考虑了软接触模型。尽管结合这些软接触模型已展示出令人印象深刻的结果，但将这些方法直接用于本工作中考虑的软操作任务具有挑战性。因为它们大多数假设简单的弹簧-阻尼器型软接触模型，这在现实中仍然与接触表面变形或弹性\[36\]-\[38\]、\[81\]存在很大不匹配。因此，精确建模复杂接触动力学的高级规划算法对于实现复杂地形上的机动或抓取不规则物体至关重要。迄今为止，将高保真可变形接触模型纳入约束TO的领域尚未得到充分探索。

**模型预测控制（MPC）。** 对于给定模型和固定时间范围的轨迹生成在计算上是禁止的，这使得在实时接触丰富的应用中难以部署，因为模型不确定性和环境干扰无处不在。模型预测控制（MPC）是一种广泛使用的强大策略，用于实时生成运动计划并适应环境干扰引起的状态变化。快速自动微分（AutoDiff）和AutoDiff兼容刚体模型的最新进展使得实时最优控制成为可能。\[85\]中的研究展示了MPC的硬件实现，其DDP优化器框架在7自由度机器人上以1000 Hz的更新速率进行基于视觉的点对点轨迹规划。

**导纳控制。** 为了应对接触中未建模的模态，我们使用基于导纳控制的低层力控制器（FC），与高层规划器相比，它具有更快的控制更新速率。它可以补偿空间上（例如，刚度、滑动性和阻尼）以及环境中干扰引起的不确定性。导纳控制已被长期研究并证明在柔顺环境中有效。此外，低层控制器可以减轻由控制更新速率、刚度不匹配和高增益引起的接触不稳定性。

本工作的主要贡献如下：

* 提出了基于软接触力学的动态交互模型，用于预定义几何形状和赫兹粘弹性理论。  
* 将交互模型纳入约束TO中，以高效、分布式的方式生成所需的笛卡尔路径和力曲线。  
* 实验验证了推导出的接触动力学模型，并实时实现了所提出的TO算法与模型预测控制（MPC）。

## **III. 可变形接触建模**

### **A. 基于赫兹理论的接触建模**

在本节中，我们根据接触几何和力学对安装在机械手上的应用工具与软组织之间的相互作用动力学进行建模。为简单起见，本研究的工具尖端呈球形（但不限于此）。我们假设所使用的工具末端尖端是刚性的，并且相对于接触表面更硬。基于这些假设，我们推导了一个基于接触摩擦理论和压力分布的接触动力学模型。根据赫兹理论，最大的静态变形发生在圆的中点（如图2中的变形所示），可以表示为：

d=316E2R9F2​​ (1)

其中 E 是工具和表面的折合杨氏模量，R 是工具末端的半径，F 是机械手工具尖端施加在表面上的力。工具尖端和软接触表面材料的组合杨氏模量可以归结为一个项：

E1​=E1​1−ν12​​+E2​1−ν22​​

其中 E1​、E2​ 和 ν1​、ν2​ 分别是末端执行器和接触表面材料的杨氏模量和泊松比。在我们的场景中，我们假设接触部分是刚体，因此球形工具尖端的杨氏模量 E1​ 相对较高。因此，集总刚度可以近似为 E=E2​/(1−ν22​)。

接触表面上的变形和应力分布通过通用胡克定律和赫兹理论近似。附录A中详细阐述了圆柱坐标系中接触区域内的法向、径向和周向（即移动方向）应力分布。

图2：表面与末端执行器工具之间软接触模型的图形说明。

变形分布由应力分布方程推导如下：

σrr​={4a3​pm​(2a2−r2),​(r≤a) pm​\[(2a2−r2)sin−1(ra​)−ar2−a2​\],​(r≥a)​

其中 pm​=F/(πa2) 是工具尖端施加在接触部分上的平均应力，a=Rd​ 是接触面积的半径（参见图2）。一个与法线成 θF​ 角的力矢量 F 施加到应用工具上，并以均匀速度 ve​ 在 {sphere} 坐标系中沿半径为 R 的曲线路径移动。这代表了工具与软表面相互作用以完成运动任务的场景。为简单起见，我们的模型侧重于滑动摩擦（主要模式），并忽略了其他摩擦源，例如由变形引起的粘附和滚动。此假设对于建模目的有效，其中粘附和滚动是次要的，并且特定于工具材料和应用。

为了推导摩擦力，我们使用接触上的主应力。如果 σθ​ 表示由于我们接触场景的对称性而在接触圆内的主应力，我们可以通过柯西应力理论在圆柱坐标系中相对于 {sphere} 坐标系表示任何接触点 (r,0,z) 的应力张量。

σ=\[σr​​0​σrz​ 0​σθ​​0 σzr​​0​σz​​\] (2)

由于任务是在笛卡尔坐标系中定义的，我们将参数从圆柱坐标系转换为笛卡尔坐标系。笛卡尔坐标系中的应力张量为 σc​=TTσT，其中变换矩阵 T 在附录A中定义。在接触表面上的任意点 (x,y,z)sphere​，从该点到球冠质心的法向量为

n=\[sθ​0​cθ​\]T。然后，接触表面的法向应力为 σn​=nTσc​n，其中

σn​=σr​c2θs2θ+σθ​s4θ+σz​c2θ+2σz​sθc2θ

给定此应力表达式，接触表面的总摩擦力表示为

df=μσn​dS=μσn​×2πrcθdr​ (3)  
f=∫dfcθ=2πμ∫0a​σn​rdr (4)  
其中，df、dr、dS 分别是摩擦、r 和接触面积的微分元素。在表面法线方向上，假设表面与工具的末端点接触。因此，式(1)始终成立。为了推导接触法线方向上的动力学模型，对式(1)进行求导：

z˙=−d˙=−\[6E2RFz​1​\]31​Fz​˙​ (5)

其中 z 表示沿接触点表面法线方向的位置，沿法线方向的力定义为 Fz​=FcosθF​。在移动方向上，式(4)和 μFz​ 给出了由法向力 Fz​ 引起的摩擦力，即：

Ff​=f=μFz​\[1+(2ν−1)10R23a2​\]nv​+kd​ve​ (6)

其中 kd​ 是移动方向上的阻尼系数。通过代入 a=Rd​ 和式(6)，我们得到了式(6)的导数形式。nv​ 是速度的单位向量，ve​ 是工具接触点在 {sphere} 坐标系中的末端执行器速度。

F˙f​=f˙​=μFz​˙​+10R3μ(2ν−1)​(Fz​˙​d−Fz​d˙)nv​+kd​v˙e​ (7)

整个模型，简单来说，F˙e​=G(Fz​,ve​,contact parameters)，其中接触模型的摩擦力和法向力分量可以紧凑地写成：

F˙e​=((6E2RFz​)31​d˙)nz​+(μF˙z​+10R3μ(2ν−1)​(Fz​˙​d+Fz​d˙))nv​+kd​v˙e​ (8)

其中 nv​ 是单位向量，d 是接触圆中心点的变形，由式(1)计算，Fz​ 是机械手施加在表面上的垂直力（表面法线方向），ve​=∣∣Jq˙​∣∣ 是工具接触点的移动速度。

我们用 cosθ=cθ 和 sinθ=sθ 表示。

### **B. 机械手动力学**

机械手模型动力学表示如下：  
q˙​=M(q)−1(τu​−C(q,q˙​)q˙​−G(q)−JTFe​) (9)  
其中 q,q˙​,q¨​,τu​∈Rk 是机械手关节位置、速度、加速度和扭矩向量。我们对7自由度机械臂使用 k=7。M(q) 是关节空间质量矩阵，C(q,q˙​) 是科里奥利项，G(q) 是重力项，τu​ 是施加在关节上的扭矩，J 是相对于接触点的雅可比矩阵，Fe​ 是末端执行器上的外部笛卡尔力矩。

### **C. 接触约束建模**

本文研究的运动主要处于滑动模式，可以用等式约束来描述。由于滑动嵌入在接触模型中，因此不需要额外的滑动约束。然而，添加了一个约束以确保机器人在所需路径上滑动，其中路径是弯曲的。图4显示了作用在工具上的力的两个分量，即沿曲率半径 Rc​ 路径的摩擦力和向心力，如图3所示。接触模型提供了滑动摩擦，并添加了向心力约束：

κJ−TM(q)J−1∣∣Jq˙​∣∣2​≤μNTFe​N (10)

其中 Fe​∈R3 是末端执行器处的力向量，J 是雅可比矩阵。κ 是运动路径的曲率（如图3所示），J−TM(q)J−1 是机器人接触点处的有效质量，其质量矩阵为 M(q)，Jq˙​ 是接触点的移动速度。N 是表面平均法向量（由力/扭矩传感器感知）。在本研究中，我们使用 N=\[0 0 1\]T，它只在z方向²。式10表示的约束在笛卡尔跟踪路径具有曲率且机器人在较低阻抗模式下运行时使机器人保持接触。它是向心力对接触处有效质量的影响。例如，如果曲线处的速度很高，它将在移动方向的正交方向上滑动，除非使用高位置增益来补偿。

²N 随表面变形而变化，表面变形是随机的，可以通过连接到末端执行器的外部力/扭矩传感器进行估计。

图3：规划框架。规划器由基于ADMM的求解器组成，以5 Hz的MPC方式执行。ADMM求解器包含三个优化子块。机械手和接触动力学模型用于全身动力学块。逆运动学块使用一阶微分运动学生成笛卡尔轨迹。状态被投影以满足投影块中的状态和接触约束。低层力控制器（即导纳控制器）以100 Hz执行。在遵守所提供的约束的同时跟踪所需的笛卡尔和力轨迹。

图4：不同笛卡尔路径几何形状。在笛卡尔路径的尖角处，机器人需要改变速度以补偿通过接触引起的向心力和摩擦力分量。

## **IV. 问题表述**

优化问题是求解一个控制轨迹，该轨迹将产生沿所需力曲线的所需笛卡尔轨迹。整个问题在表述1中表述，其中状态表示为 x=\[q q˙​ Fe​\]T

**表述1 同时轨迹和力优化**

**目标函数**

(跟踪任务) minΦ​∑i=0N​δF\[i\]TQF​δF\[i\]+u\[i\]TRu\[i\]

(姿态跟踪) \+Wp​∣∣FK(q\[i\])−xed​\[i\]∣∣22​

(决策变量) ϕ\[i\]=\[\[q\[i\] q˙​\[i\] Fe​\[i\]\]T,u\[i\]T\]T

∀i=1,...,N−1 (11a)

**约束条件**

(动力学) s.t. x\[i+1\]=f(x\[i\],u\[i\]) (11b)

(初始条件) x\[0\]=x0​ (11c)

(关节限制) qlower​≤q\[i\]≤qupper​ (11d)

(扭矩限制) ulower​≤u\[i\]≤uupper​ (11e)

(接触约束) κJ−TM(q)J−1∣∣Jq˙​∣∣2​≤μNTFe​N (11f)

结合式(8)中的接触动力学模型和式(9)中的机械手动力学模型后，整个系统动力学可以通过欧拉法离散化并写成式(11b)中的函数 f(⋅,⋅)。初始条件 x0​ 如式(11c)所示。关节和扭矩限制在式(11d)和式(11e)中定义，分别具有下限和上限对 (qlower​,qupper​) 和 (ulower​,uupper​)。式(11f)中讨论的滑动接触约束（在第三节-C中讨论）也需要纳入优化问题。接下来，我们描述如何以分布式方式解决表述1，即所提出的ADMM算法。

## **V. 带有接触动力学的约束轨迹优化**

给定机械手和接触动力学模型，微分动态规划（DDP）用于生成所需的关节和笛卡尔运动以及遵循由 f(⋅,⋅) 定义的系统动力学的力曲线。DDP因有效解决无约束轨迹优化而广受好评。它代表了一种间接方法，只优化控制输入，并且在正向轨迹展开过程中隐式满足动力学约束。给定控制输入的初始猜测，通过正向传播系统动力学的微分方程生成更新的状态轨迹。然后为成本函数和动力学围绕当前轨迹构建二次近似，以便可以使用Riccati递归来推导最优反馈控制律。通过迭代更新状态和控制轨迹，优化将收敛到最优解。

DDP的一个局限性在于其难以处理除正向传递过程中强制的动力学约束之外的约束。由于我们的接触模型强制执行状态、控制和摩擦约束，因此需要将这些接触约束以及状态和控制约束纳入其中。我们之前在\[45\]中的工作提出了一种基于交替方向乘子法（ADMM）的迭代分布式方法来纳入接触动力学和附加约束。在这项工作中，我们引入了一个逆运动学子问题，并将整个ADMM框架扩展为一种共识变体，以进一步提高计算效率。请注意，也可以建立顺序变体。详细信息在附录B中展示，我们在第七节-A中对多种变体进行了基准测试。

ADMM算法将一个大规模的整体优化问题分解为子问题，并迭代求解每个子问题。在每次迭代中，原始问题和对偶问题依次求解。在温和条件下，来自原始问题和对偶问题的所有变量集都收敛到最优解。有关ADMM算法的更多详细信息请参阅\[71\]。为了将此算法应用于我们的软接触操作问题，我们定义了各种副本集和相应的一致性约束。因此，原始的表述1被转换为分布式版本，如表述2所示。为简单起见，我们定义 λ=(q˙​T,Fe​T)T 和 ϕ=(q​\[0,...,N\],u\[0,...,N−1\],λ\[0,...,N\])3 来表示需要投影的状态和控制的连接副本。同时，变量集 ϕ^​=(q^​\[0,...,N\]) 表示关节位置 xM​ 的副本，并处理末端执行器跟踪，即逆运动学（IK）。闭合凸集 J、U 和 F 分别代表关节限制(11d)、控制限制(11e)和接触约束(11f)。通过使用指示函数（如果目标变量在可行集中则指定为零值，否则为无限大值），上述约束被编码为表述2中新成本函数内部的成本项 II.U.F​。

³决策变量q和A是完整状态x的子集。

**表述2 分布式约束优化（共识）**

(跟踪任务) minϕ,ϕ^​,ϕ​​∑i=0N​δF\[i\]TQF​δF\[i\]+u\[i\]TRu\[i\]

\+Wp​∣∣FK(q\[i\])−xed​\[i\]∣∣22​  
\+IF,U,F​(q​\[i\],u\[i\],λ\[i\])  
(变量-DDP) ϕ\[i\]=\[\[q˙​\[i\]q˙​\[i\]q˙​\[i\]Fe​\[i\]\]T,u\[i\]T\]T

(变量-IK) ϕ^​\[i\]=q^​\[i\]T  
(变量-Proj) ϕ​\[i\]=\[q​\[i\]T,u\[i\]T,λ\[i\]T\]T  
∀i=0,1,...,N−1 (12a)

(动力学) s.t. x\[i+1\]=f(x\[i\],u\[i\]) (12b)

(初始条件) x\[0\]=x0​ (12c)

(一致性约束)  
{q^​=q^​ q=q^​ u=u λ=λ​ (12d)  
然后可以推导出并写成以下形式的增广拉格朗日（AL）的缩放形式（参见\[71\]第3.1.1节）：

L(ϕ,ϕ^​,ϕ​,v)=∑i=0N​(δF\[i\]TQF​δF\[i\]+u\[i\]TRu\[i\])  
\+Wp​∣∣FK(q^​\[i\])−xed​\[i\]∣∣2​  
\+I\_{\\mathcal{F}},\\mathcal{U},\\mathcal{F}}(\\overline{q}\[i\],\\overline{u}\[i\],\\overline{\\lambda}\[i\])  
\+2ρj​​∣∣q^​−q​+vik​∣∣22+2ρj​∣∣q−q​+vj​∣∣22​  
\+2ρu​​∣∣u−u+vu​∣∣22+2ρf​∣∣λ−λ+vf​∣∣22​  
其中 ϕ、ϕ^​ 和 ϕ​ 是原始变量。vik​、vj​、vu​ 和 vf​ 是与(12d)中定义的每个一致性约束相关的对偶变量。ρj​、ρu​ 和 ρf​ 是对应于每个约束的步长参数。请注意，由于前两个一致性约束具有相同的投影目标 xM​，因此两个约束都采用了参数 ρj​。

然后，基于ADMM，原始问题被分为三个子问题，也称为子块。每个子块只需要上述AL的一部分作为局部成本函数：

全身动力学子块：

Lwbd(ϕ,ϕ​,v)=∑i=0N(δF\[i\]TQF​δF\[i\]+u\[i\]TRu\[i\])  
\+2ρj​​∣∣q−q​+vj​∣∣22+2ρu​∣∣u−u+vu​∣∣22​  
\+2ρf​​∣∣λ−λ+vf​∣∣22​ (13)  
逆运动学子块：

Lik(ϕ^​,ϕ​,v)=∑i=0NWp​∣∣FK(q^​\[i\])−xed​\[i\]∣∣2​  
\+2ρj​​∣∣q^​−q​+vik​∣∣22​ (14)  
投影子块：

Lproj(ϕ,ϕ^​,ϕ​,v)=∑i=0NIJ,U,F​(q​\[i\],u\[i\],λ\[i\])  
\+2ρj​​∣∣q^​−q​+vik​∣∣22+2ρj​∣∣q−q​+vj​∣∣22​  
\+2ρu​​∣∣u−u+vu​∣∣22+2ρf​∣∣λ−λ+vf​∣∣22​ (15)  
然后，对于每个ADMM迭代 k，缩放形式的更新序列为

ϕk+1=arg minϕ​Lwbd​(ϕ,ϕ​k,vk)  
s.t. Eq. (12b) (16a)  
ϕ^​k+1=arg minϕik​​Lik​(ϕ^​,ϕ​k,vk) (16b)

ϕ​k+1=arg minϕ​​Lproj​(ϕk+1,ϕ^​k+1,ϕ​k,vk) (16c)

vikk+1​=vikk​+q^​k+1−q​k+1 (16d)

vjk+1​=vjk​+qk+1−q​k+1 (16e)

vuk+1​=vuk​+uk+1−uk+1 (16f)

vfk+1​=vfk​+λk+1−λk+1 (16g)

值得注意的是，式(16a)和式(16b)都只依赖于前一个ADMM迭代 k 的解，这意味着与附录B中所示的顺序更新相比，上述两个步骤可以并行执行。

为了高效解决式(16a)中的约束优化问题，部署了DDP，并且通过执行正向传递，状态轨迹始终是动态可行的。对于式(16c)，这个最小化问题简化为凸集 J、U 和 F 上的投影算子。

ϕ​k+1=arg minϕ​∈C​2ρj​​∣∣q^​k+1−q​+vikk​∣∣22​  
\+2ρj​​∣∣qk+1−q​+vjk​∣∣22​  
\+2ρu​​∣∣uk+1−u+vuk​∣∣22+2ρf​∣∣λk+1−λ+vfk​∣∣22​  
C=(q​,u,λ)∣q​∈J,u∈U,λ∈F

然后可以使用饱和函数将不可行值高效地投影到由不同约束引起的边界上：

ϕ​k+1=ΠJ,U,F​\[21​(q^​k+1+vikk​+qk+1+vjk​),  
uk+1+vuk​,λk+1+vfk​\] (17)  
我们的ADMM算法的整个过程如算法1所示。ϕ​ 和对偶变量 v 的选择是任意的，我们将其初始化为零。ϕ 的初始轨迹是通过运行正向动力学并使用初始控制猜测生成的。函数 DDP(⋅) 和 IK(⋅) 对应于我们的DDP求解器和IK求解器的实现。在每个ADMM迭代中，上次ADMM迭代的控制将被作为热启动发送到当前的DDP求解器，这使得DDP求解器在初始迭代后在每个ADMM迭代中在大约十次迭代内更快地收敛。然后迭代求解轨迹，直到满足停止准则（关于原始残差，参见\[71\]第3.3节）（残差幅度为 10−2）。

## **VI. 模型预测控制**

我们在实时部署中以模型预测控制（MPC）的方式实现ADMM规划器。在每个MPC周期中，求解式(11)中的优化问题，其时间范围为 H=Nsteps​δt，其解用作下一个MPC周期的热启动，即 (x0​,u0​)←(x\[i\],u\[i\])，其中 x0​ 被某个初始状态 x\[i\] 替换。发送给机器人的控制输入计算如下。

u\[i\]∗=uff​\[i\]+ufb​\[i\]+ufc​\[i\]  
\=u\[i\]+K(xcurr−x\[i\])+δuFC​(Fe​\[i\],Fecurr​) (18)  
其中，xcurr=\[q˙​currq˙​currFecurr​\]T 是经过滤波（低通）的当前状态，K∈Rn×n 是增益矩阵。u\[i\] 由三项组成：前馈（ff）、反馈（fb）和导纳力控制器（fc）。

**备注1:** KUKA Sunrise 软件\[88\]中的低层控制器内部使用用户定义的关节空间阻抗控制。我们设置了一个安全的机器人阻抗来执行我们的命令，并允许机械手在柔顺环境中安全地行为。

高层MPC循环以5 Hz的频率实现，时间范围为1秒，时间步长为 dt=0.02 秒。在每个MPC迭代中，我们通过ADMM规划器（如第五节所述）求解轨迹，并且我们所有的代码实现都使用C++11。为了保持接触力精度并避免由于低频控制更新速率引起的不稳定性\[44\]、\[89\]，我们使用低层力控制器

代码实现可在 [https://github.com/lasithagt/admm](https://github.com/lasithagt/admm) 找到。

图5：模型预测控制（MPC）实现。H、T 和 s1​ 分别是时间范围的步数、计算延迟的步数和系统当前的步数。计算需要T步。在此期间，执行线程继续执行之前的计划。一旦规划线程完成，当前执行计划将更新；对应于延迟的时间步将被截断。

它以100 Hz的速率更新控制输入，该更新速率适用于柔顺（低刚度）环境。

在其中一个ADMM规划器块中，我们使用DDP来求解机器人和接触动力学，这消耗了大部分计算能力。为了使实时实现可行，我们使用CppADCodeGen \[90\]提供的自动微分进行导数计算，并使用RobCoGen \[84\]来推导分析刚体动力学模型。在Linux机器（Intel i7）上，主频为3.4 GHz，1秒时间范围的平均计算时间为150毫秒。如果没有自动微分和分析模型，则需要1300毫秒。有了自动微分，MPC可以以大约5 Hz的速率运行。

DDP的每次迭代平均需要10毫秒，我们将DDP迭代次数限制在每个ADMM周期10次，以确保求解器及时返回最优轨迹。我们在每个轨迹计算周期中最多运行5次ADMM迭代。虽然不能保证约束残差在每次轨迹迭代中都达到相同的阈值，但我们的实验结果表明，5次ADMM迭代足以将残差降低到 10−2 的数量级。在理想的MPC设置中，输出轨迹的第一个控制输入应用于机器人，并且当前状态用作下一次迭代MPC计算的初始状态。然而，在实际设置中，轨迹规划器可能存在显著的计算负担。为了考虑硬件系统中的计算和通信延迟，我们使用类似于\[91\]的异步MPC，如图5所示。当前状态 (x\[t\]) 应用于规划器。计算轨迹需要T个时间步。在此期间，执行之前的轨迹。在T个时间步后，规划器返回轨迹 Ut,t+H​=ut​,...,ut+H​。在轨迹的实际执行中，我们将控制输入序列截断到T个时间步，如图5所示。规划器和执行线程使用C++11中的线程库并行运行在不同的线程中。

尽管MPC在处理模型不确定性和环境干扰方面有益，但这不足以满足需要力调节的任务。这是由于接触可能引起的不稳定性，并由控制更新速率和表面材料特性决定\[44\]、\[89\]。我们使用以100 Hz速率更新控制输入的力控制器，以避免接触引起的不稳定性。导纳控制已被证明\[86\]更适合柔顺环境，而阻抗控制最适合刚性环境。

力控制很重要，因为表面参数不均匀且容易受到未建模动力学（例如，阻尼、恢复、滑动）的影响。为了补偿这一点，我们使用导纳控制作为低层控制中的力控制器。为了减轻基于位置的导纳控制可能引起的不稳定性\[92\]，我们使用扭矩作为控制输入，而不是位置控制。接触表面材料的刚度是根据\[44\]中描述的方法估计的。

δuFC​\[t\]=C(x,y,z)JT(Fe​\[t\]−Fecurr​\[t\]) (19)

其中 J(q) 是运动学雅可比矩阵，δuFC​\[t\] 是关节空间扭矩，C(x,y,z) 是柔顺矩阵，它可以在空间上变化（在 (x,y,z)5 空间中）。

## **VII. 实验**

为了验证我们工作理论属性的实际适用性，我们通过在定制平台上进行的物理实验来证明（如图6所示）。此外，我们将我们的框架与在仿真（MATLAB®）中广泛用于机器人运动规划的其他最先进方法进行比较。然后，我们展示了接触参数识别方法，并将结果与干扰引起的跟踪任务进行比较。

### **A. 轨迹优化算法比较**

分布式运动规划方案（如ADMM）的主要动机是使用针对每个子问题专门优化的不同方法，并将约束纳入其中。例如，使用一阶微分方法生成IK解决方案并单独求解动力学模型以在它们之间找到共识是高效的。这些方法在MATLAB®中进行了基准测试，处理器为3.4 GHz i7核心。此外，我们将我们的方法与其他标准方法进行基准测试，即：

1. **我们的方法：** 具有3块架构的ADMM（共识）。具有三个块的ADMM架构：非线性动力学、IK和投影块被求解，并在ADMM更新中找到共识。更多细节可在附录B中找到。  
2. **顺序二次规划（SQP）。** 使用梯形转录的直接配置与具有接触动力学的动力学系统一起使用；  
3. **迭代线性二次调节器（iLQR香草DDP）。** iLQR \[57\] 与期望笛卡尔轨迹（SE(3)）、力轨迹、状态、控制和接触约束的组合成本一起使用；  
4. **具有2块架构的ADMM（顺序）。** 使用\[45\]中实现的具有2块的ADMM方案。在非线性动力学块中，DDP求解器中使用期望的状态和控制成本。投影块投影到状态、控制和接触约束；  
5. **具有3块架构的ADMM（顺序）。** 具有三个块的ADMM架构：非线性动力学、IK和投影块在ADMM更新中顺序求解。更多细节可在附录B中找到。

图7显示了上述方法的成本降低和约束残差降低的比较。对于ADMM变体，x轴表示动态求解器（DDP）迭代次数，而不是ADMM迭代次数，以便与其他方法（例如SQP和iLQR）进行公平比较。

图6：实验设置。KUKA机械手配备球形工具和ATI力/扭矩传感器，位于接触点远端。脉动平台以1Hz的固定速率上下移动。表面覆盖着厚厚的软基板。末端执行器的工具由一个与可变形表面接触的球形压头组成。

图7：优化方法比较。3块共识、3块顺序、2块顺序、香草DDP、SQP。左：成本与迭代次数。成本经过归一化，使得初始值缩放为1。香草DDP和SQP收敛性相当，3块共识最快。右：约束残差（对数）与迭代次数。3块共识残差收敛更快，尽管初始约束违反较高。

### **B. 计算时间基准测试**

表I总结了每种算法的计算时间。这些算法在Matlab中离线实现，用于整个轨迹，并使用有限差分计算导数。观察到3块共识耗时最短，而2块顺序耗时最长。虽然SQP的成本和残差收敛与3块共识相当，但其耗时约为3块共识的两倍。香草DDP（成本全部集中）的计算时间与3块共识相当，但残差成本不会像其他方法那样随时间快速衰减。总的来说，3块共识方法以快速的残差误差衰减率提供了最佳计算时间。

| 方法 | 时间(s) \[10³\] |
| :---- | :---- |
| 3块-共识 | 3.0966 |
| 3块顺序 | 6.6121 |
| 2块顺序 | 16.620 |
| 香草DDP | 4.8436 |
| SQP | 6.0421 |

表I：3块共识、3块顺序、2块顺序、香草DDP和SQP的算法时间。整个轨迹在具有相同时间步数的约束下求解。3块共识耗时最短，而2块顺序耗时最长。

### **C. 成本降低**

使用具有3块架构的ADMM的一个优点是可以在不增加动力学块中额外成本项的情况下跟踪参考笛卡尔轨迹（SE(3)），这可能会阻碍DDP的快速收敛。在这种方法中，笛卡尔轨迹可以通过差分IK和冗余系统冗余解析高效求解。此外，该解决方案可以为动力学块提供热启动。图7（左）是我们的方法与其他现有方法的比较。从图7中可以明显看出，以共识方式求解的3块架构ADMM收敛速度更快。顺序变体在适当的惩罚参数（p）下收敛速度较慢。另一方面，SQP和香草DDP方法的成本收敛与基准相当，但需要更多迭代才能使约束残差降至 10−2 的满意阈值。

### **D. 约束满足**

图7（右）中记录了每次迭代的约束残差，并针对每种方法调整了成本系数。观察到，3块架构的共识ADMM中的残差下降速度相对快于其他方法。SQP方法最初以较低的残差值开始并增加（然后再次减少）。这种观察可以归因于SQP求解器在预处理阶段寻找一个满足约束的初始解，而不管目标成本如何。iLQR保持残差不变，没有显著改进。这是由于成本和约束的组合成本项，将成本优先于约束。

### **E. 实验结果**

在我们之前的工作\[45\]中，我们通过实验证明了当环境平台静止时接触模型的有效性。在这项工作中，我们将其扩展到非静止环境，其中施加周期性干扰（1Hz脉动），如图6所示。此外，我们证明了所提出框架实时部署的可行性。实验结果可归纳为以下几类：

1. 在存在和不存在环境干扰的情况下进行开环轨迹。

图8：摩擦模型验证和识别。µ \= 0.4512，Kd \= 13.1315，R-squared \= 0.9103。

2. 激活低层力控制器时的开环轨迹。  
3. 在存在和不存在干扰的情况下，带有低层力控制器的模型预测控制器（MPC）。

### **F. 材料属性的系统识别**

为了实验验证所提出的软接触模型，需要识别与接触体材料相关的参数，例如摩擦系数和杨氏模量。摩擦系数通过在材料表面上执行预定运动来估计，同时通过连接到末端执行器（图6）的ATI mini45传感器记录力/扭矩数据。

杨氏模量通过使用相同的球形末端执行器点几何形状在材料表面上进行循环线性探测来估计（在材料测试平台INSTRON©上进行测试）。它是通过非线性最小二乘估计器使用式(1)和式(6)来估计摩擦系数的，如下所示。式(20)总结了参数估计问题。

minE​∑k=0N​∣∣dk​−316E2R9Fk2​​​∣∣2Derived from Eq. (1) (20a)  
minμ,kd​​∑k=0N​∣∣dk​−μFz​\[1+(2ν−1)10R23a2​\]nv​−kd​ve​∣∣2Derived from Eq. (6) (20b)  
式20给出了参数的识别。运动方向上的摩擦力大小 Ffric​、速度大小 ve​ 和法向接触力 Fz​ 从收集到的数据中计算。在MATLAB©中，使用逻辑距离函数拟合了三维鲁棒最小二乘近似。这种拟合用于减轻模型偏差的敏感性，因为变形会增加（参见图8）。识别出的杨氏模量和摩擦系数被纳入式(11)中的整体优化中。要跟踪的期望状态是期望的末端执行器位置 (xe​,ye​,ze​) 和期望的法向接触力 Fz​。

识别材料属性的目的有两方面。首先，验证所使用的模型是否适合并在轨迹优化框架中使用以生成最优开环轨迹。摩擦数据拟合结果如图8所示。数据拟合的R平方值为0.9103。识别出摩擦系数（µ \= 0.4512）和阻尼系数（kd \= 13.1315）。

观察到，随着表面法向力的增加，变形的影响主导了摩擦力。这种现象是由于滚动摩擦增加和材料特有的伪影，例如摩擦系数和应力分布的不均匀性。此外，流体或任何微粒的存在会增加不均匀性。

在实现中，通过式(11)中表述的优化生成最优状态轨迹和输入。在原始和对偶停止准则中，约束在 10−2 的残差值违规范围内得到满足。图8显示所使用的接触模型在一定范围的法向力下是有效的。因此，期望的接触力保持在摩擦模型的有效范围内。

### **G. 无环境干扰的开环轨迹生成**

从我们的轨迹优化方法生成的开环轨迹用作实验的参考轨迹。接触力（例如，由于摩擦和变形引起的）的任何不匹配将直接影响运动，反之亦然。观察到，通过TO求解的控制输入能够比位置控制机器人更好地跟踪运动 (xed​) 和力曲线 (Fd)，如图9所示。这是由于其对接触交互过程中遇到的摩擦力和向心力进行了开环补偿。表II给出了图9所示结果的量化。尽管即使使用所提出的方法，跟踪性能也并非最优，但由于软材料未建模动力学、粘滞和不均匀性引起的模型不准确性，其性能得到了显著改善。我们将在以下段落中详细阐述结果。

图9：顶行：末端执行器跟踪的路径与指令路径的比较。底行：法向力和摩擦力的真实值与模型预测值的比较。

| 运动路径 1 | 运动路径 2 | 运动路径 3 |
| :---- | :---- | :---- |
| 路径 (m) | 力 (N) | 路径 (m) |
| 脉动，无FC | 0.0142 | 2.723 |
| 脉动，带FC | 0.0839 | 1.095 |
| 脉动，MPC \+ FC | 0.0258 | 0.573 |

表II：运动和力的RSME，FC-导纳力控制，MPC-模型预测控制。

如第七节-G所述，相同的开环完整轨迹在力控制下执行，如第六节所述。图9显示了实验结果，这表明仅低层力控制（蓝色轨迹）可以显著提高参考力跟踪精度。然而，由于实验结果中观察到的表面摩擦力，参考运动跟踪精度会下降。参考力与运动跟踪性能在主动力控制和MPC（绿色轨迹）下得到改善。此外，表II显示了在具有不同曲率的不同几何形状的多个运动轨迹上的量化结果。观察到，在没有力控制的情况下，运动精度更好，但力跟踪更差。另一方面，在力控制和MPC下，运动和力精度都得到了改善，如相应的RSME值所示。在包含尖锐曲线（例如矩形几何形状）的笛卡尔几何形状中，向心力分量是接触力补偿中摩擦力的附加部分，角落处的速度需要改变以保持路径和接触，如图4所示。未能补偿它可能导致滑动并偏离期望运动（图9中的无FC情况）。在直线中只需要补偿摩擦力，而在曲线几何形状中同时存在向心力和摩擦力分量。

### **H. 周期性环境干扰下的低层力控制器模型预测控制**

在第七节-G中，我们展示了力控制和MPC可以同时提高力跟踪精度和运动跟踪精度。然而，在实际环境中，环境会受到运动干扰。为了应对这种干扰并同时补偿摩擦力，我们通过实验展示了所提出的轨迹优化（TO）方法的有效性。图10说明了在力控制下、无力控制下以及有力控制和MPC下，力跟踪精度和运动跟踪精度如何。与静态情况类似，低层力控制提高了力跟踪精度，但在力跟踪中可以观察到“反应性”性质（在图10右栏第二行子图中）。因此，具有接触模型信息的MPC显著提高了力跟踪精度和运动跟踪精度。此外，系统在外部引起的运动干扰和模型不确定性下保持稳定。这种成功可以归因于低层导纳控制器和以MPC方式运行的基于模型的TO。实验在多个笛卡尔轨迹上进行，以验证不同几何形状，量化结果报告在表III中。

图10：左：表面脉动时的法向力和摩擦力。比较激活力控制器（蓝色）、未激活力控制（橙色）和MPC与激活力控制（绿色）。右：归一化力和运动叠加在热图上。请注意，实验平台（图6）的运动脉动导致力曲线中观察到的波纹，控制器正试图补偿这些波纹。

| 运动路径 1 | 运动路径 2 | 运动路径 3 |
| :---- | :---- | :---- |
| 路径 (m) | 力 (N) | 路径 (m) |
| 无FC | 0.284 | 1.042 |
| 带FC | 0.0183 | 0.384 |
| MPC \+ FC | 0.0164 | 0.283 |

表III：运动和力的RSME，FC-导纳力控制，MPC-模型预测控制，运动路径1（圆形），运动路径2（八字形），运动路径（直线）。

### **I. 讨论与局限性**

实验和结果证明了将接触纳入TO框架对于更好的力和运动跟踪精度的重要性。在安全关键应用中，刚性、位置控制的机器人不受欢迎，因为它们可能引发安全问题。基于接触模型的力控控制架构可以提供安全和改进的性能。

我们的静态环境结果比运动引起的动态环境表现出更好的性能。将环境运动干扰（例如，呼吸、心跳）拟合到参数模型可以进一步提高跟踪性能。在我们目前的工作中，机器人的阻抗设置为预定义模式，这可能具有限制性。例如，高阻抗机器人更适合需要更高运动精度而非力的任务，反之亦然。根据任务和应用调整机器人的阻抗可以进一步提高安全性、力和运动跟踪精度。

虽然我们的工作提出了一种力和运动TO的方法，但我们承认其在应用和计算技术方面的多重局限性。例如，我们使用的接触模型仅在局部有效。对于大型可变形体，接触模型将需要更昂贵的计算方法（例如，有限元方法）。此外，在整个实验中，力的大小范围保持在局部范围（图8中的线性范围）。为了补偿高变形和润滑情况下的摩擦，需要学习或建模变形摩擦的其他因素。

尽管这项工作实现了MPC在线规划，但还有更多有前景的TO并行化机制\[93\]-\[95\]可以进一步提高计算性能。例如，(i) 在DDP反向传递中，通过Riccati递归的并行化方法\[82\]可以实现计算加速；(ii) 在DDP正向传递中，可以通过首先提出近似物理模型来加速计算，其中可以评估粗略模型的计算成本较低的估计\[96\]。然后，生成的粗略轨迹可以作为TO的初始种子，并使用精细模型。这个粗细问题可以通过迭代过程解决。(iii) 最后，上述这些机制将适用于GPU处理器上的并行ADMM实现。尽管这项工作不侧重于TO并行化机制，但这些潜在方向值得报告，并且可以为可变形组织操作和医疗机器人社区提供有益的见解。

## **VIII. 结论与未来工作**

在需要物理软组织接触的自动化任务中，设计软接触交互模型至关重要，控制器可以设计来保证安全性能。接触建模对于正确识别接触材料和执行诸如沿给定路径切口和运动干扰补偿等日常任务至关重要。本研究提出了一个用于柔顺表面上同时进行运动和力调节的连贯框架。此外，我们提出了一个分布式（ADMM）、实时框架，以MPC方式执行，能够处理状态、控制和接触约束。此外，我们将软接触动力学模型纳入了轨迹优化（TO）。结果证明，在静态和动态环境中，运动和力跟踪精度都得到了显著提高。这项工作的潜在应用包括在软组织或安全关键环境中的接触操作。

通过TO求解的轨迹在软表面（EcoFlex©）上进行了实验验证，借助带有球形工具尖端的机器人机械手。估计了表面材料特性，并进一步用于生成最优轨迹。实验在静态和运动引起的动态环境中进行。展示了MPC在有无力控制下的结果。使用力/扭矩传感器（ATI mini45）获得了真实力，并与获得的结果进行了比较。带有力控制的MPC能够在静态和动态环境中同时跟踪运动和力，并取得了显著改进。结果和讨论得出结论，基于模型的接触建模和分层TO（例如，低层和高层）为安全同时生成力和运动提供了更好的选择。

这项工作的未来扩展是提高接触模型的通用性（即“丰富性”）以适应更广泛的材料特性。此外，实时估计接触模型属性可以提高规划框架的适应性。此外，我们打算将工作扩展到在三维表面上规划轨迹，以展示实际应用，例如在人体上规划机器人切口。

## **附录A**

**可变形补丁接触模型**

在本附录中，我们提供了一些应力分布的详细信息。首先，法向应力分布 σz​:

pm​σz​​=−23​1−a2r2​​(r≤a) (21)

径向应力分布 σr​:

pm​σr​​=22ν−1​r2a2​(1−1−a2r2​​)−23ν​1−a2r2​​(r≤a)

周向应力分布 σθ​:

pm​σθ​​=21−2ν​r2a2​(1−1−a2r2​​)−23​1−a2r2​​(r≤a)

其中 pm​=F/(πa2) 是操作在接触部分施加的平均应力，a=Rd​ 是接触面积的半径（参见图2）。变换矩阵 T 为

T=\[cθ​sθ​0 −sθ​cθ​0 0​0​1​\]

## **附录B**

**三块顺序ADMM**

与在IK子块和投影子块之间建立一致性约束（即表述2中的 q^​=q​）不同，顺序ADMM在DDP子块和IK子块之间强制执行等式，即 q=q^​，如表述3所示。

与共识变体不同，原始优化问题被分解为：

**表述3 分布式约束优化（顺序）**

(跟踪任务) minϕ,ϕ^​,ϕ​​∑i=0N​δF\[i\]TQF​δF\[i\]+u\[i\]TRu\[i\]  
\+Wp​∣∣FK(q\[i\])−xed​\[i\]∣∣22​  
\+IJ,U,F​(q​\[i\],u\[i\],λ\[i\])  
(变量-DDP) ϕ\[i\]=\[\[q\[i\] q˙​\[i\] Fe​\[i\]\]T,u\[i\]T\]T  
(变量-IK) ϕ^​\[i\]=q^​\[i\]T  
(变量-Proj) ϕ​\[i\]=\[q​\[i\]T,u\[i\]T,λ\[i\]T\]T  
∀i=0,1,…,N−1 (22a)

(动力学) s.t. x\[i+1\]=F(x\[i\],u\[i\]) (22b)

(初始条件) x\[0\]=x0​ (22c)

(一致性约束)  
{q=q^​ q=q​ u=u λ=λ​ (22d)  
全身动力学子块：

Lwbd(ϕ,ϕ^​,ϕ​,v)=∑i=0N(δF\[i\]TQF​δF\[i\]+u\[i\]TRu\[i\])  
\+2ρj​​∣∣q−q^​+vikk​∣∣22​+2ρj​​∣∣q−q​+vjk​∣∣22​  
\+2ρu​​∣∣u−u+vu​∣∣22​+2ρf​​∣∣λ−λ+vf​∣∣22​  
逆运动学子块：

Lik(ϕ,ϕ^​,v)=∑i=0NWp​∣∣FK(q^​\[i\])−xed​\[i\]∣∣22​  
\+2ρj​​∣∣q−q^​+vik​∣∣22​  
投影子块：

Lproj(ϕ,ϕ​,v)=∑i=0NIJ,U,F​(q​\[i\],u\[i\],λ\[i\])  
\+2ρj​​∣∣q−q​+vj​∣∣22​+2ρu​​∣∣u−u+vu​∣∣22​  
\+2ρf​​∣∣λ−λ+vf​∣∣22​