# **不确定环境下动态接触力跟踪的自适应变阻抗控制**

## **摘要**

传统的恒定阻抗控制是一种简单而有效的方法，广泛应用于包括接触力跟踪在内的许多领域。使用该方法时，必须已知环境相对于机器人的位置和环境的刚度，并且通常期望力是恒定的。然而，对于不确定环境下动态接触力跟踪的应用，这不是一个有效的解决方案。在本文中，提出了一种新的自适应变阻抗控制用于力跟踪，它能够跟踪动态期望力并补偿环境中（几何和机械特性方面的）不确定性。本研究分析了机器人末端执行器与环境的接触力模型。具体而言，接触力被用作基于位置的阻抗控制器的反馈力，以在不确定环境中主动跟踪动态期望力。为了适应任何环境刚度不确定性，提出了一种改进的阻抗控制。为了减少由环境位置不确定性引起的力跟踪误差，首次通过在线调整阻抗参数，根据跟踪误差来补偿未知环境和动态期望力，从而实现了自适应变阻抗控制。此外，还证明了自适应变阻抗控制的稳定性和收敛性，以实现稳定的力跟踪执行。进行了仿真和实验，以比较恒定阻抗控制和自适应变阻抗控制的力跟踪性能。结果有力地证明了所提出的方法可以比恒定阻抗控制获得更好的力跟踪性能。

## **1\. 引言**

随着机器人技术的发展，接触操作正在成为机器人应用的重要领域。典型的例子包括装配、抛光、去毛刺、双臂协作或灵巧手操作。对于这些应用，机器人与环境之间的交互控制对于成功执行任务至关重要，因为机器人（或某些部件）必须接触并操作物体表面。在这些情况下，纯粹使用运动控制策略来控制接触力是不合理的，因为当机器人与环境交互时，在遵循期望轨迹的同时应保持期望力。

只有当整个任务能够准确、完整地规划时，才能成功执行交互任务，这要求机器人和环境都得到适当建模，并且所有参数都准确已知。通常，机器人建模可以足够准确地知道，但环境的精确模型很难获得。

## **2\. 系统模型与控制**

本节将讨论本文中使用的系统交互模型。然后介绍带有力跟踪策略的基于位置的阻抗控制。

### **2.1. 机器人与环境模型**

为了对机器人和环境的接触力进行建模，机器人由一个二阶质量-弹簧-阻尼系统表示，环境也由一个二阶质量-弹簧-阻尼系统表示，与其他文献中一样。但在本文中，为了从一个简单的情况开始，我们考虑环境是刚性的。设 ke​ 为环境的刚度，m, b 和 k 分别为机器人末端执行器的质量、阻尼和刚度。设 f 为机器人与环境一旦建立接触后施加的当前接触力。

机器人与环境之间的接触过程可以分为两个阶段，如图 1 所示。在第一阶段，机器人正在接近环境。而在第二阶段，末端执行器与环境接触。图 2 显示了机器人与环境接触时的接触力图。

如图 2 所示，从 0∼t1​，自由空间中没有接触。从 t2​∼t3​，系统在碰撞过程后将稳定。碰撞是不可避免的，但碰撞时间是瞬态且高度非线性的。

### **2.2. 基于位置的阻抗控制用于力跟踪**

在大多数文献中，基于力的阻抗控制用于力跟踪已被广泛研究。然而，大多数商业化机器人强调位置轨迹跟踪的准确性，不提供力控制模式。因此，在这些机器人上不可能进行基于力的阻抗控制。作为替代，基于位置的阻抗控制被认为是实现位置控制机械手柔顺交互的实用方法。图 3 显示了用于力跟踪的基于位置的阻抗控制示意图。

在图 3 中，Xr​、Xc​ 和 Xm​ 分别表示参考位置轨迹、发送给机器人的指令位置轨迹和测量的位置轨迹。假设在位置控制模式下 Xc​=Xm​，由于接触力引起的位置扰动 E 可以表示为 E=Xm​−Xr​=Xc​−Xr​。Xe​ 指的是环境的位置。由于假设环境是刚性的，因此环境由刚度为 Ke​ 的线性弹簧表示。机器人与环境之间的接触力然后简化为 Fe​=Ke​(Xe​−Xm​)=Ke​(Xe​−Xc​)。设 Fd​ 为期望接触力，则力跟踪误差为 ΔF=Fe​−Fd​。

通常，阻抗模型选择为具有传递函数 K(s)=1/(Ms2+Bs+K) 的线性二阶系统，因此力跟踪误差 ΔF 和位置扰动 E 之间的动态关系可以表示为：

Mdt2d2E(t)​+BdtdE(t)​+KE(t)=ΔF(t)(1)  
其中 M 是质量，B 是阻尼，K 是刚度。扰动 E 用于修改参考位置轨迹 Xr​ 以产生指令轨迹 Xc​=Xr​+E=Xr​+ΔFK(s)，然后由伺服驱动系统跟踪。

每个笛卡尔变量都是独立的。不失一般性，以一维为例，力跟踪误差 Δf 可以写成：

Δf=fe​−fd​=ke​(xe​−xc​)−fd​=ke​xe​−ke​(xr​+k(s)Δf)−fd​(2)  
将 k(s)=1/(ms2+bs+k) 代入 (2) 式，得到：

Δf(ms2+bs+k+ke​)=(ms2+bs+k)\[ke​(xe​−xr​)−fd​\](3)  
稳态力跟踪误差然后从 (3) 式中获得：

Δfs​=k+ke​k​\[ke​(xe​−xr​)−fd​\](4)  
从 (4) 式可以看出，为了使力跟踪误差在稳态下收敛到零，参考位置必须满足以下方程：

xr​=xe​−ke​fd​​(5)  
(5) 式表明，如果精确的环境位置 xe​ 和环境刚度 ke​ 的精确值已知，则可以根据 (5) 式计算参考位置轨迹 Xr​ 以在环境上施加期望接触力 fd​。然而，在实践中，Xe​ 和 ke​ 的值是未知的。根据 \[4\] 中的分析，很难直接补偿环境位置 Xe​ 和环境刚度 ke​。将存在一个无限的稳态力跟踪误差，因为力误差始终存在。

基于上述问题，下一节提出了一种新的自适应变阻抗控制来实现在不确定环境信息情况下的力跟踪。

## **3\. 基于自适应变阻抗控制的动态力跟踪**

本节将解决不确定环境中的两个问题。(1) 环境刚度未知或动态变化。(2) 环境位置动态变化。

### **3.1. 未知环境刚度**

以下是对环境刚度未知或动态变化的分析。将 E=Xc​−Xr​ 和 ΔF=Fe​−Fd​ 代入 (1) 式，得到：

Fe​−Fd​=M(X¨c​−X¨r​)+B(X˙c​−X˙r​)+K(Xc​−Xr​)(6)  
根据第 2 节的分析，由于未知环境信息，难以获得准确的参考轨迹 Xr​。因此，用初始环境位置 Xe​ 替换 Xr​，新的阻抗方程然后转换为：

Fe​−Fd​=M(X¨c​−X¨e​)+B(X˙c​−X˙e​)+K(Xc​−Xe​)(7)  
现在位置扰动 E 可以写成 E=Xc​−Xe​。为简单起见，在后续分析中我们以一维相互作用力为例。然后 (7) 式可以表示为：

Δf=fe​−fd​=me¨+be˙+ke(8)  
如果期望力 fd​=0，当 xc​=xe​ 时满足 Δfss​=0。这意味着机器人刚刚与环境接触，接触力 fe​ 为零。在这种情况下，(8) 式始终适用于任何环境刚度 ke​。

如果期望力 fd​=0，期望力 fd​ 作为驱动力使机器人对环境施加力，因此 xc​=xe​，这意味着当系统稳定时 Δfss​=0。如 \[24\] 所示，将刚度 k 设置为零将满足 fe​=fd​ 的理想稳态条件，适用于任何 ke​。

因此，所提出的控制律是将刚度 k=0。(8) 式得到：

Δf=fe​−fd​=me¨+be˙(9)  
将 fe​=ke​(xe​−xc​)=−ke​e 代入 (9) 式，接触阻抗律为：

me¨+be˙+ke​e=−fd​(10)  
分析表明，即使环境刚度 ke​ 未知，也可以根据 ke​ 的近似值选择适当的 m 和 b 来满足 (10) 式，从而当系统稳定时，我们有 Δfss​=0。

因此，我们可以得出结论，当环境刚度未知或动态变化时，通过设置 k=0 可以实现期望的力跟踪效果。

### **3.2. 动态环境位置**

以下分析环境位置动态变化的情况。将 e=xc​−xe​ 代入 (9) 式，得到：

fe​−fd​=m(x¨c​−x¨e​)+b(x˙c​−x˙e​)(11)  
如果在平面上操作，其中 x¨e​=x˙e​=0，我们有 Δfss​=0，这意味着系统绝对稳定。

如果在斜坡或更复杂的未知表面上操作，xe​ 是时变的，并且 x˙e​=0 或 x¨e​=0。因此环境位置需要估计。假设环境位置的估计是 x^e​=xe​−δxe​。然后位置误差表示为 e^=e+δxe​。用 e^ 替换 (9) 式中的 e，得到：

fe​−fd​=me^¨+be^˙=m(e¨+δx¨e​)+b(e˙+δx˙e​)(12)  
在 (12) 式中，fe​, fd​, e˙, e¨ 都是时变的。换句话说，使用前面使用的控制律，力跟踪误差在任何时候都存在。为了获得 Δfss​=0，引入自适应变阻抗控制来补偿时变误差。考虑到系统的稳定性，阻抗模型中的阻尼系数被调整，但不建议修改质量系数，因为它容易导致系统振荡。因此，提出自适应变阻抗律为：

fe​(t)−fd​(t)=me^¨(t)+(b+Δb(t))e^˙(t)(13)  
Δb(t) 根据力误差在线调整，其形式为：

{Δb(t)=e^˙(t)b​Φ(t)Φ(t)=Φ(t−λ)+σbfd​(t−λ)−fe​(t−λ)​​(14)⎩⎨⎧​X¨c​(t)=X¨c​(t−1)+M1​\[ΔF(t)−B(t)(X˙c​(t−1)−X˙c​(t))\]X˙c​(t)=X˙c​(t−1)+X¨c​(t)TXc​(t)=Xc​(t−1)+X˙c​(t)T​(15)  
其中 λ 是控制器的采样周期，σ 是更新速率。

为了方便工业机器人控制中的应用，(13) 式可以转换为其离散形式：

其中 T 是机器人控制器和伺服驱动器之间的系统通信周期。

所提出的力跟踪结构如图 4 所示。

## **4\. 自适应变阻抗律的稳定性和收敛性**

自适应变阻抗的形式在 (13) 和 (14) 式中给出。下面给出了自适应变阻抗稳定性的约束条件，并证明了当系统渐近稳定时力跟踪误差为零。将 (14) 式代入 (13) 式，得到：

f\_e(t)-f\_d(t)=m\\ddot{\\hat{e}}(t)+b\\dot{\\hat{e}}(t)+b\\Phi(t-\\lambda)$$$$+\\sigma\[f\_d(t-\\lambda)-f\_e(t-\\lambda)\]$$$$=m(\\ddot{e}(t)+\\delta\\ddot{x}\_e(t))+b(\\dot{e}(t)+\\delta\\dot{x}\_e(t))\+bΦ(t−λ)+σ\[fd​(t−λ)−fe​(t−λ)\](16)  
重新组织 (16) 式得到：

m\\ddot{e}(t)+b\\dot{e}(t)+b\\Phi(t-\\lambda)-\[f\_e(t)-f\_d(t)\]$$$$+\\sigma\[f\_d(t-\\lambda)-f\_e(t-\\lambda)\]$$$$=-m\\delta\\ddot{x}\_e(t)-b\\delta\\dot{x}\_e(t) \\quad (17)  
根据机器人与环境之间的刚度模型，fe​=ke​(xe​−xc​)=−ke​e，它变成：

{e˙=−f˙​e​/ke​e¨=−f¨​e​/ke​​(18)  
将 (18) 式代入 (17) 式，得到：

−mf¨​e​(t)−bf˙​e​(t)+bke​Φ(t−λ)−ke​\[fe​(t)−fd​(t)\]+σke​\[fd​(t−λ)−fe​(t−λ)\]=−mke​δx¨e​(t)−bke​δx˙e​(t)(19)  
设 f^​e​(t)=ke​δxe​(t)，则 (19) 式可以表示为：

m\\ddot{f}\_d(t)-m\\ddot{f}\_e(t)+b\\dot{f}\_d(t)-b\\dot{f}\_e(t)+bk\_e\\Phi(t-\\lambda)$$$$+\\sigma k\_e\[f\_d(t-\\lambda)-f\_e(t-\\lambda)\]-k\_e\[f\_e(t)-f\_d(t)\]$$$$=m\\ddot{f}\_d(t)-m\\ddot{\\hat{f}}\_e(t)+b\\dot{f}\_d(t)-b\\dot{\\hat{f}}\_e(t) \\quad (20)  
将 c(t)=fd​(t)−fe​(t) 和 r(t)=fd​(t)−f^​e​(t)，重写 (20) 式为：

mc¨+bc˙+bke​Φ(t−λ)+σke​c(t−λ)+ke​c=mr¨+br˙(21)  
根据离散原理，Φ 系列的 n 个元素可以展开为 \[24\]：

bΦ(t−λ)=bΦ(t−(n+1)λ)+σc(t−(n+1)λ)+⋅⋅⋅+σc(t−2λ)(22)  
通常，将自适应补偿的初始值 Φ(t−(n+1)λ)=0 设置为零，因此 (21) 式可以重写为：

mc¨+bc˙+ke​c+σke​(c(t−(n+1)λ)+...+c(t−λ))=mr¨+br˙(23)  
根据拉普拉斯变换的延迟性质 L\[f(t−τ)\]=e−τsF(s)。(23) 式得到以下方程：

r(s)c(s)​=ms2+bs+ke​+σke​(e−(n+1)λs+⋅⋅⋅+e−λs)ms2+bs​(24)  
(24) 式的稳定性可以通过特征方程 (25) 保证：

ms2+bs+ke​+σke​(e−(n+1)λs+⋅⋅⋅+e−λs)=0(25)  
假设 n 是一个足够大的数字，它可以表示为：

n=1∑∞​e−λns=1−e−λse−λs​(26)  
当采样率 λ 足够时，延迟项可以近似为 e−λs≃1−λs（通过泰勒展开）。(25) 式可以写成：

λms3+λbs2+ke​λ(1−σ)s+σke​=0(27)  
根据劳斯判据，我们得到劳斯表，如 (28) 式所示。为了确保系统的稳定性，第一列的系数和特征方程的系数必须为正，如 (29) 式所示。

s^3 \\quad \\lambda m \\quad k\_e\\lambda(1-\\sigma)$$$$s^2 \\quad \\lambda b \\quad \\sigma k\_e$$$$s^1 \\quad \\frac{\\lambda b k\_e \\lambda (1-\\sigma)-\\lambda m \\sigma k\_e}{\\lambda b} \\quad 0s0σke​00(28)⎩⎨⎧​λbλbke​λ(1−σ)−λmσke​​\>0ke​λ(1−σ)\>0σke​\>0​(29)  
简化 (29) 式，得到：

0\<σ\<m+λbλb​(30)  
对于一个稳定的系统，稳态误差 ess​ 是根据拉普拉斯变换定义的。为了收敛，稳态误差 ess​ 可以得到：

ess​=t→∞lim​e(t)=s→0lim​sE(s)=s→0lim​s(c(s)−r(s))(31)  
当输入是形式为 r(s)=(1/s) 的阶跃函数时，(31) 式得到：

ess​=s→0lim​s(c(s)−r(s))=−1(32)  
根据 (32) 式，可以得出以下结论：

s→0lim​sc(s)=0(33)t→∞lim​c(t)=0(34)  
因此，当 t→∞ 时，fe​→fd​。机器人与环境之间的接触力收敛到动态期望力。实际上，即使 r(s) 不是常数，例如实验中的正弦函数，我们也可以证明跟踪误差趋于零。

## **5\. 仿真和实验**

为了验证所提出的力跟踪方法和分析，本节进行并介绍了系列仿真和实验研究。所提出的方案的性能首先通过仿真进行测试。仿真包括各种力跟踪场景，基本涵盖了大多数实际情况。进行了三项实验研究以测试实际应用的可行性。

### **5.1. 仿真研究**

在以下仿真实验中，在各种不确定环境下测试并比较了 (11) 式所示的经典恒定阻抗控制和 (13) 和 (14) 式所示的自适应变阻抗控制。仿真环境基于 Matlab Simulink，包括两部分：阻抗控制和接触力模型。仿真框图如图 5 所示，仿真不考虑任何扰动。

#### **5.1.1. 平面上的力跟踪**

如果接触环境是平面，则满足 x˙e​=x¨e​=0。假设 m=1,k=0,xe​=0.1 m, fd​=5 N。将 xc​ 设置为大于 xe​ 的值，例如本文中的 xc​=0.2 m。换句话说，机器人一开始不与环境接触。为了测试 (11) 式对不确定环境刚度的鲁棒性，突然将环境刚度改变为：

ke​=⎩⎨⎧​1000 (N/m),3000 (N/m),5000 (N/m),​0≤t≤66≤t≤88≤t≤10​(35)  
图 6 和图 7 分别显示了固定阻抗控制在平面上的位置跟踪和力跟踪结果。阻尼系数 b=42 可以获得理想的效果。图 6 显示机器人在 0∼0.4 s 之间从自由空间移动到受限空间。一旦末端执行器与环境接触，从图 7 可以看出，当环境刚度变化时，在短暂的力调整后可以跟踪期望力。

上述实验结果表明，恒定阻抗控制对变化的T环境刚度具有鲁棒性。因此，当机器人在平面上操作或环境刚度变化时，经典的恒定阻抗控制可以实现良好的力跟踪效果。

#### **5.1.2. 斜面上的力跟踪**

如果接触环境是斜面，则满足 x˙e​=0,x¨e​=0。该实验旨在比较经典阻抗控制和自适应变阻抗控制对环境动态变化的适应性，因此设置初始位置 xc​=xm​=0, ke​=5000(N/m), fd​=50 N，其他假设相同。

图 8-11 分别显示了机器人在斜面上操作时，使用恒定阻抗控制和自适应变阻抗控制的位置和力跟踪仿真结果。

对于恒定阻抗控制，阻尼系数 b=60 可以用于获得稳定的力跟踪值。但图 9 显示稳定值为 f^​d​=65 N，存在较大误差。对于自适应变阻抗控制，初始阻尼系数 b=100 和更新速率 σ=0.5 可以用于获得稳定的力跟踪值，图 11 显示自适应变阻抗控制在短暂的自适应调整后可以达到期望的稳定值。

通过上述实验结果，我们可以得出结论，尽管恒定阻抗控制可以实现稳定值，但它不能跟踪期望力。因此，自适应变阻抗控制优于恒定阻抗控制。

#### **5.1.3. 正弦面上的力跟踪**

如果接触环境是正弦面，则满足 x˙e​=0,x¨e​=0，其他假设相同。图 12-15 显示了机器人在正弦面上操作时的位置和力跟踪仿真结果。

图 13 显示，无论选择哪个 b，力跟踪误差始终存在，并且估计的力趋势偏向一侧。因此，在这种情况下力跟踪是不收敛的。但图 15 显示，自适应变阻抗控制在短暂的自适应调整后可以达到期望的稳定值。

#### **5.1.4. 复杂表面上的力跟踪**

本实验的目的是测试自适应阻抗控制对复杂表面力跟踪的鲁棒性。图 16 和图 17 显示了机器人在复杂表面上操作时基于自适应变阻抗控制的位置和力跟踪仿真结果。它表明当系统稳定时力跟踪误差为零。

此外，为了测试自适应变阻抗控制是否能够适应动态期望力，因此将 fd​ 设置为时变序列。图 18 和图 19 显示了机器人在复杂表面上操作时基于自适应变阻抗控制的位置和力跟踪仿真结果，其中 fd​ 是时变的。仿真结果表明，当系统稳定时力跟踪误差为零。

从以上四项仿真实验，我们可以得出结论：(1) 对于平面，即使环境刚度不确定，恒定阻抗控制也能实现期望的力跟踪效果。(2) 但对于斜坡或更复杂的未知表面，恒定阻抗控制无法实现期望的力跟踪。(3) 自适应变阻抗控制不仅可以实现任何表面上的期望力跟踪性能，而且还可以适应动态期望力。

因此，仿真实验表明，自适应变阻抗控制在不确定环境中可以实现非常好的跟踪效果。

### **5.2. 实验研究**

为了验证所提出算法的性能，使用如图 20 所示的试验台进行了实验。该试验台由四部分组成：自主开发的开放控制器、伺服驱动器、一台 ESTUN ER16 工业机械手和一台 Optoforce HEX-70-XE-1000N 腕部力传感器（Fz​ 的额定容量为 1000N，变形为 1 mm，精度为 3%FS）。伺服驱动器通过 EtherCAT 与控制器通信。力传感器和控制器通过 UDP 通信，通信周期均为 5 ms。机器人末端执行器上安装了一个基于滑轮的装置，用于精确跟踪接触位置和力。

为了验证仿真研究，进行了三项实验来测试所提出算法的可行性，如图 21 至 23 所示。平面和斜面是硬质桌面，如图 21 和图 22 所示。复杂表面是混合曲面，包括正弦面和平面，如图 23 所示，正弦面是刚性的，平面是塑料的，正弦面和平面之间的连接处有一个凹槽。每个表面的确切位置和刚度都是不确定的。考虑机器人沿负 z 方向移动到表面上，然后沿 y 方向沿表面移动 40 cm，z 方向的 fd​=−12 N。

在第一个实验中测试了恒定阻抗控制策略，在第二个和第三个实验中测试了自适应变阻抗控制算法。实验结果如图 24 至 26 所示。在初始状态下，末端执行器从自由空间移动到表面之外的一个点。fd​ 用于驱动机器人与表面接触。与表面接触后，在短暂调整后，期望力平稳跟踪。

图 24 显示，一旦末端执行器与表面接触，就会发生初始过冲，并且力在大约 15 秒内稳定到 \-12 N。图 25 显示，在短暂的力调整后，跟踪在大约 15 秒内稳定在 \-12 N。图 26 显示，从 10 秒到 27 秒，自适应变阻抗控制可以跟踪曲面，尽管力存在一些误差。从 27 秒到 28 秒，末端执行器穿过正弦面和平面连接处的凹槽。在 28 秒时，环境刚度发生变化。在 28 秒到 31 秒的短暂调整后，可以跟踪力。在整个实验中，初始阻尼系数 b=100 和更新速率 σ=0.5 用于获得稳定的力跟踪值。

## **6\. 结论**

力跟踪是接触操作中最重要的问题之一。提出了一种新的自适应变阻抗控制，用于不确定环境中的动态力跟踪。

分析了不确定环境的两个关键因素：未知环境刚度和动态环境位置。对机器人和环境的动态物理特性进行了建模。改进了基于传统阻抗控制的修正阻抗控制律，以适应任何环境刚度。为了解决动态环境位置问题，研究了一种基于力反馈的自适应变阻抗控制策略，通过调整阻抗参数来补偿位置误差。

为了验证所提出算法的可行性，进行了仿真和实验研究。测试结果表明，恒定阻抗控制只能应用于平面力跟踪，而自适应变阻抗控制可以用于各种不确定环境，如斜面或其他复杂的未知表面。所提出的算法不仅用于跟踪静态期望力，还可以用于动态期望力跟踪。它可以扩展到许多涉及力跟踪的情况，并为接触操作提供了更有效的解决方案。